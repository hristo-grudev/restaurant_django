{% extends 'base.html' %}
{% load static %}

{% block page_content %}
    <h1 class='text-center'>
        Маса {{ pk }}
    </h1>
    {% if not order %}
        <div class="row">
            <div class="col-lg-3"></div>
            <div class="col-lg-6">
                <form method="post" class="container mb-5" action="{% url 'order start' pk %}">
                    {% csrf_token %}
                    {{ order_form }}
                    <button class="btn btn-primary mt-2" type="submit">Start order</button>
                </form>
            </div>
            <div class="col-lg-3"></div>
        </div>
    {% else %}
    <div class="container mb-5">
        <div class="row mb-5">
        {% for cat in categories %}
            <div class="card ml-3 mb-3" style="width: 10rem;">
{#                <img src="{{ cat.image.url }}"#}
{#                     class="card-img-top" alt="Photo description">#}
                <div class="card-body">

{#                    <h5 class="card-title">{{ cat.name }}</h5>#}
                    <!-- Button to the Photo Details Page -->
                    <a href="{% url 'table details' pk %}?category={{ cat.id }}" class="btn btn-primary">{{ cat.name }}</a>
                </div>
            </div>
        {% endfor %}
        </div>

    </div>
        <div class="d-flex justify-content-between">
            <form method="GET" >
                <input type="text" name="item">
                <button class="btn btn-primary mt-2" type="submit">Търси</button>
            </form>
        </div>
    <div>
        {% for item in searched_items %}
            <div class="d-flex justify-content-between">
{#                    <p>{{ item.name }}</p>#}
{#                    <a class="btn btn-primary" href="{% url 'order add item' pk %}?order={{ order.0.id }}&item={{ item.id }}">Добави</a>#}
                <form method="post" action="{% url 'order add item' pk %}">
                    {% csrf_token %}
                    {{ order_details_form.order }}
                    <input type="text" value="{{ item.name }}" disabled readonly>
                    <input type="hidden" name="food_and_drinks" id="id_food_and_drinks" value="{{ item.id }}" required>
                    {{ order_details_form.pcs }}
                    <button>Добави</button>
                </form>
            </div>
        {% endfor %}
    </div>
    <div>
        {% for item in items %}
            <div class="d-flex justify-content-between">
{#                    <p>{{ item.name }}</p>#}
{#                    <a class="btn btn-primary" href="{% url 'order add item' pk %}?order={{ order.0.id }}&item={{ item.id }}">Добави</a>#}
                <form method="post" action="{% url 'order add item' pk %}">
                    {% csrf_token %}
                    {{ order_details_form.order }}
                    <input type="text" value="{{ item.name }}" disabled readonly>
                    <input type="hidden" name="food_and_drinks" id="id_food_and_drinks" value="{{ item.id }}" required>
                    {{ order_details_form.pcs }}
                    <button>Добави</button>
                </form>
            </div>
        {% endfor %}
    </div>
        <div>
            <br>
        </div>
    {% endif %}
    <div class="float-left">
        {% for item in ordered_items %}

            {% if item.id not in sent_items %}
                <form method="post" action="{% url 'remove item' pk item.id %}">
                    <div class="d-flex justify-content-between">
                        {% csrf_token %}
                        {{ delete_form }}
                        <p>{{ item.food_and_drinks }}</p>
                        <p>{{ item.pcs|floatformat:0 }}</p>
                        <button>Откажи</button>
                    </div>

                </form>
                {% else %}
                <form method="post" action="{% url 'remove item' pk item.id %}">
                    <div class="d-flex justify-content-between">
                        {% csrf_token %}
                        <p>{{ item.food_and_drinks }}</p>
                        <p>{{ item.pcs|floatformat:0 }}</p>
                        <p>Готов</p>
                    </div>

                </form>
            {% endif %}
        {% endfor %}
    </div>
{% endblock %}